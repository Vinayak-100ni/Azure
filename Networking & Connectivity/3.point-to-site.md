ğŸ§© Architecture
User Laptop â”€â”€VPN Clientâ”€â”€Internetâ”€â”€Azure VPN Gatewayâ”€â”€Azure VNet

âœ… Prerequisites

Azure subscription

Azure VNet

Client OS (Windows / macOS / Linux)

Non-overlapping IP ranges

ğŸŸ¢ STEP 1: Create Azure Virtual Network

Azure Portal â†’ Virtual Networks

Click + Create

Configure:

Address space: 10.0.0.0/16

Subnet: 10.0.1.0/24

Create

ğŸŸ¢ STEP 2: Create Gateway Subnet

Open the VNet

Go to Subnets

Click + Gateway subnet

CIDR:

10.0.255.0/27


Save

âš ï¸ Subnet name must be GatewaySubnet

ğŸŸ¢ STEP 3: Create Virtual Network Gateway

Azure Portal â†’ Virtual Network Gateways

Click + Create

Configure:

Gateway type: VPN

VPN type: Route-based

SKU: VpnGw1

Virtual network: Select your VNet

Public IP: Create new

Create

â³ Takes ~30â€“45 minutes

ğŸŸ¢ STEP 4: Configure Point-to-Site Settings

Open Virtual Network Gateway

Go to Point-to-site configuration

Click Configure now

ğŸŸ¢ STEP 5: Configure P2S Address Pool

Address pool (client IPs):

172.16.0.0/24


âš ï¸ Must NOT overlap with VNet or on-prem CIDRs

ğŸŸ¢ STEP 6: Choose Authentication Type
Option A: Azure AD Authentication (Recommended)

Authentication type: Azure Active Directory

Tenant: https://login.microsoftonline.com/<tenant-id>

Audience: 41b23e61-6c1e-4545-b367-cd054e0ed4b4

Issuer: https://sts.windows.net/<tenant-id>/

âœ” Best for enterprises
âœ” No certificates required

Option B: Certificate-Based Authentication
6.1 Create Root Certificate (Local)
New-SelfSignedCertificate `
 -Type Custom `
 -KeySpec Signature `
 -Subject "CN=P2SRootCert" `
 -KeyExportPolicy Exportable `
 -HashAlgorithm sha256 `
 -KeyLength 2048 `
 -CertStoreLocation "Cert:\CurrentUser\My" `
 -KeyUsageProperty Sign `
 -KeyUsage CertSign

6.2 Export Public Key

Export .cer (Base-64)

6.3 Upload Root Certificate

Azure Portal â†’ P2S config â†’ Root certificates

Upload .cer

ğŸŸ¢ STEP 7: Select VPN Tunnel Type

Choose:

OpenVPN (SSL) âœ… (Recommended)

IKEv2

SSTP (Windows only)

ğŸŸ¢ STEP 8: Save Configuration

Click Save
â³ Takes a few minutes

ğŸŸ¢ STEP 9: Download VPN Client

Go to Point-to-site configuration

Click Download VPN client

Extract package

ğŸŸ¢ STEP 10: Connect from Client
Windows

Run installer

Connect via VPN settings

macOS / Linux

Use OpenVPN client

Import .ovpn config

ğŸŸ¢ STEP 11: Test Connectivity

Ping Azure VM private IP

SSH / RDP to VM

Access private endpoints
